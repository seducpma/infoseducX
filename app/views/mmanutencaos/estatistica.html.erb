<br/>
 <table  class="tabelas1"   align="center" width="100%">
  <tr>
    <th align="left" >
       <font  size=5 color="black"> <b> ESTATÍSTICAS SERVIÇO DE MANUTENÇÃO</b></font>
    </th>
    <td width="3%">
     <center><%= link_to image_tag("/stylesheets/images/excluir.PNG", :size => "20x20"),  homes_path, {:method => "get"}, :title => "Fechar"%></center>
   </td>
  </tr>
  <tr>
    <td colspan="3">
      <table border="2" width="100%">
        <tr>
          <td align="left" colspan="6">
             <font color ="black" size="3" ><b><center><u><font size="4"> ESTATÍSTICA</font></u> </center></b></font>
          </td>
        </tr>
       <tr>
         <td colspan="6" align="left"><font size="4"><b><%=(Date.today.strftime("%B"))%></b></font></td>
       </tr>
            <%  session[:ano] =(Date.today.year).to_s%>
            <%  session[:mes] =(Date.today.month).to_s%>
            <%  $data = session[:ano]+'-'+session[:mes]+'-'+'01' %>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="black "size="2">
            <b> Total no Mês:<%= @mmanutencaos_todosM = Mmanutencao.all(:conditions => ["created_at > ?", $data] ).count %></b>
           </font>
          </td>
          <td width="15%"><b><%=link_to'Alvenaria:', estatisticasM_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 1 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Dedetização:', estatisticasM_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Eletrodomésticos:', estatisticasM_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Elétrica:', estatisticasM_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletriM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Cozinha:', estatisticasM_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and created_at > ?", $data]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b><%=link_to'Hidráulica:', estatisticasM_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidrauM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Marcenaria:', estatisticasM_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Pintura:', estatisticasM_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and created_at > ?", $data]).count %></td>
          <td width="15%" colspan="2"><b><%=link_to'Limpeza Cx.D Agua:', estatisticasM_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and created_at > ?", $data]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b><%=link_to'Playground:', estatisticasM_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Poda Grama:', estatisticasM_mmanutencaos_path(:estatisticas => '13')%></b><%= @mmanutencaos_gramaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Serralheira:', estatisticasM_mmanutencaos_path(:estatisticas =>'11')%></b><%= @mmanutencaos_serralheriaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Telhado:', estatisticasM_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_telhadoM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and created_at > ?", $data]).count %></td>
          <td width="15%"><b><%=link_to'Outros:', estatisticasM_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and created_at > ?", $data]).count %></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="red "size="2">
            <b>Em Aberto: <%= @mmanutencaos_abertoM = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 1 and created_at > ?", $data] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="red"><b><%=link_to'Alvenaria:', estatisticasMA_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Dedetização:', estatisticasMA_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Eletrodomésticos:', estatisticasMA_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Elétrica:', estatisticasMA_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletricaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Cozinha:', estatisticasMA_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b><%=link_to'Hidráulica:', estatisticasMA_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidraulicaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Marcenaria:', estatisticasMA_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Pintura:', estatisticasMA_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%" colspan="2"><font color ="red"><b><%=link_to"Limpeza Cx.D'Agua:", estatisticasMA_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b><%=link_to'Playground:', estatisticasMA_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Poda Grama:', estatisticasMA_mmanutencaos_path(:estatisticas => '13')%></b><%= @mmanutencaos_gramaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Seralheria:', estatisticasMA_mmanutencaos_path(:estatisticas => '11')%></b><%= @mmanutencaos_serralheriaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Telhado:', estatisticasMA_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_telhadoAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Outros:', estatisticasMA_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=1 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="blue "size="2">
            <b>Em Encerrado: <%= @mmanutencaos_encerrado = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 2 and created_at > ?", $data] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="blue"><b><%=link_to'Alvenaria:', estatisticasME_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Dedetização:', estatisticasME_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Eletrodomésticos:', estatisticasME_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Elétrica:', estatisticasME_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletricaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Cozinha:', estatisticasME_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b><%=link_to'Hidráulica:', estatisticasME_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidraulicaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Marcenaria:', estatisticasME_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Pintura:', estatisticasME_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%" colspan="2"><font color ="blue"><b><%=link_to"Limpeza Cx.D'Agua:", estatisticasME_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b><%=link_to'Playground:', estatisticasME_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Poda Grama:', estatisticasME_mmanutencaos_path(:estatisticas => '13')%></b><%= @mmanutencaos_serralheriaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Serralheria:', estatisticasME_mmanutencaos_path(:estatisticas => '11')%></b><%= @mmanutencaos_telhadoE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Telhado:', estatisticasME_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_gramaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b><%=link_to'Outros:', estatisticasME_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="gren "size="2">
            <b>Em Atendimento: <%= @mmanutencaos_atendimento = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 3 OR situacao_manutencao_id= 4  and created_at > ?", $data]).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="gren"><b><%=link_to'Alvenaria:', estatisticasMAt_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 1 and (situacao_manutencao_id= 3 OR situacao_manutencao_id= 4)  and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Dedetização:', estatisticasMAt_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Eletrodomésticos:', estatisticasMAt_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Elétrica:', estatisticasMAt_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletricaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Cozinha:', estatisticasMAt_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b><%=link_to'Hidráulica:', estatisticasMAt_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidraulicaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Marcenaria:', estatisticasMAt_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Pintura:', estatisticasMAt_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%" colspan="2"><font color ="gren"><b><%=link_to"Limpeza Cx.D'Agua:", estatisticasMAt_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b><%=link_to'Playground:', estatisticasMAt_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Poda Grama:', estatisticasMAt_mmanutencaos_path(:estatisticas => '13')%></b><%=@mmanutencaos_gramaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Serralheira:', estatisticasMAt_mmanutencaos_path(:estatisticas => '11')%></b><%= @mmanutencaos_serralheriaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Telhado:', estatisticasMAt_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_telhadoAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b><%=link_to'Outros:', estatisticasMAt_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and (situacao_manutencao_id=3 OR situacao_manutencao_id=4) and created_at > ?", $data]).count %></font></td>
       </tr>
       <tr><td colspan="5"></td></tr>

<!-- mes anterior  mes anterior mes anterior mes anterior mes anterior-->


       <tr>
         <td colspan="6" align="left"><font size="4"><b><%=(Date.today<<1).strftime("%B")%></b></font></td>
       </tr>
            <%  session[:ano] =(Date.today.year).to_s%>
            <%  session[:mes] =((Date.today.month)-1).to_s%>
            <%  $datai = session[:ano]+'-'+session[:mes]+'-'+'01' %>
            <%  $dataf = session[:ano]+'-'+session[:mes]+'-'+'30' %>
        <tr>
          <td rowspan="3" align="right" valign="top" width="25%">
           <font color ="black "size="2">
            <b> Total no Mês : <%= @mmanutencaos_todosMA = Mmanutencao.all(:conditions => ["created_at > ? and created_at < ?", $datai, $dataf] ).count %></b>
           </font>
          </td>
          <td width="15%"><b><%=link_to'Alvenaria:', estatisticasMANT_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Dedetização:', estatisticasMANT_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Eletrodomésticos:', estatisticasMANT_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Elétrica:', estatisticasMANT_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletricaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Cozinha:', estatisticasMANT_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b><%=link_to'Hidráulica:', estatisticasMANT_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidraulicaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Marcenaria:', estatisticasMANT_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Pintura:', estatisticasMANT_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%" colspan="2"><b><%=link_to"Limpeza Cx.D'Agua:", estatisticasMANT_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b><%=link_to'Playground:', estatisticasMANT_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Poda Grama:', estatisticasMANT_mmanutencaos_path(:estatisticas => '13')%></b><%= @mmanutencaos_gramaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Serralheira:', estatisticasMANT_mmanutencaos_path(:estatisticas => '11')%></b><%= @mmanutencaos_serralheriaM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Telhado:', estatisticasMANT_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_telhadoM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
          <td width="15%"><b><%=link_to'Outros:', estatisticasMANT_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and created_at > ? and created_at < ?", $datai, $dataf]).count %></td>
       </tr>
       <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="red "size="2">
            <b>Em Aberto: <%= @mmanutencaos_abertoMA = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 1 and created_at > ? and created_at < ?", $datai, $dataf] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="red"><b><%=link_to'Alvenaria:', estatisticasMA_mmanutencaos_path(:estatisticas => '1')%></b><%= @mmanutencaos_alvenariaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Dedetização:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '2')%></b><%= @mmanutencaos_dedetizacaoAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Eletrodomésticos:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '3')%></b><%= @mmanutencaos_eletroAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Elétrica:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '4')%></b><%= @mmanutencaos_eletricaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Cozinha:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '5')%></b><%= @mmanutencaos_cozinhaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]) %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b><%=link_to'Hidráulica:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '6')%></b><%= @mmanutencaos_hidraulicaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Marcenaria:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '7')%></b><%= @mmanutencaos_marcenariaAM= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Pintura:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '8')%></b><%= @mmanutencaos_pinturaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%" colspan="2"><font color ="red"><b><%=link_to"Limpeza Cx.D'Agua:", estatisticasMANTA_mmanutencaos_path(:estatisticas => '9')%></b><%= @mmanutencaos_aguaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b><%=link_to'Playground:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '10')%></b><%= @mmanutencaos_playAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Poda Grama:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '13')%></b><%= @mmanutencaos_gramaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Seralheria:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '11')%></b><%= @mmanutencaos_serralheriaAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Telhado:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '12')%></b><%= @mmanutencaos_telhadoAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
          <td width="15%"><font color ="red"><b><%=link_to'Outros:', estatisticasMANTA_mmanutencaos_path(:estatisticas => '14')%></b><%= @mmanutencaos_outrosAM = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=1 and created_at > ? and created_at < ?", $datai, $dataf]).count %></font></td>
        </tr>



        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="blue "size="2">
            <b>Em Encerrado: <%= @mmanutencaos_encerrado = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 2 and created_at > ?", $data] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="blue"><b>Alvenaria:</b><%= @mmanutencaos_alvenariaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Dedetização:</b><%= @mmanutencaos_dedetizacaoE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletroE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Elétrica:</b><%= @mmanutencaos_eletricaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Cozinha:</b><%= @mmanutencaos_cozinhaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b>Hidráulica:</b><%= @mmanutencaos_hidraulicaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Marcenaria:</b><%= @mmanutencaos_marcenariaE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Pintura:</b><%= @mmanutencaos_pinturaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%" colspan="2"><font color ="blue"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_aguaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b>Playground:</b><%= @mmanutencaos_playE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Poda Grama:</b><%= @mmanutencaos_serralheriaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Serralheria:</b><%= @mmanutencaos_telhadoE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Telhado:</b><%= @mmanutencaos_gramaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Outros:</b><%= @mmanutencaos_outrosE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=2 and created_at > ?", $data]).count %></font></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="gren "size="2">
            <b>Em Atendimento: <%= @mmanutencaos_atendimento = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 3 OR situacao_manutencao_id= 4  and created_at > ?", $data]).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="gren"><b>Alvenaria:</b><%= @mmanutencaos_alvenariaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Dedetização:</b><%= @mmanutencaos_dedetizacaoAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletroAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Elétrica:</b><%= @mmanutencaos_eletricaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Cozinha:</b><%= @mmanutencaos_cozinhaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b>Hidráulica:</b><%= @mmanutencaos_hidraulicaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Marcenaria:</b><%= @mmanutencaos_marcenariaAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Pintura:</b><%= @mmanutencaos_pinturaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%" colspan="2"><font color ="gren"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_aguaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b>Playground:</b><%= @mmanutencaos_playAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Poda Grama:</b><%= @mmanutencaos_serralheriaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Serralheira:</b><%= @mmanutencaos_telhadoAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Telhado:</b><%= @mmanutencaos_gramaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Outros:</b><%= @mmanutencaos_outrosAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=3 OR situacao_manutencao_id=4 and created_at > ?", $data]).count %></font></td>
       </tr>






       <tr>
         <td colspan="6" align="left"><font size="3"><b>GERAL</b></font></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="black "size="2">
            <b> Total Geral:<%= @mmanutencaos_todos.count %></b>
           </font>
          </td>
          <td width="15%"><b>Alvenaria:</b><%= @mmanutencaos_alvenaria = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",1]).count %></td>
          <td width="15%"><b>Dedetização:</b><%= @mmanutencaos_dedetizacao= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",3]).count %></td>
          <td width="15%"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletro= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",4]).count %></td>
          <td width="15%"><b>Elétrica:</b><%= @mmanutencaos_eletrica = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",5]).count %></td>
          <td width="15%"><b>Cozinha:</b><%= @mmanutencaos_cozinha = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",6]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b>Hidráulica:</b><%= @mmanutencaos_hidraulica = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",7]).count %></td>
          <td width="15%"><b>Marcenaria:</b><%= @mmanutencaos_marcenaria= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",9]).count %></td>
          <td width="15%"><b>Pintura:</b><%= @mmanutencaos_pintura = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",10]).count %></td>
          <td width="15%" colspan="2"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_agua = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",8]).count %></td>
        </tr>
        <tr>
          <td width="15%"><b>Playground:</b><%= @mmanutencaos_play = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",11]).count %></td>
          <td width="15%"><b>Poda Grama:</b><%= @mmanutencaos_serralheria = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",12]).count %></td>
          <td width="15%"><b>Serralheira:</b><%= @mmanutencaos_telhado = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",13]).count %></td>
          <td width="15%"><b>Telhado:</b><%= @mmanutencaos_grama = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",14]).count %></td>
          <td width="15%"><b>Outros:</b><%= @mmanutencaos_outros = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= ?",15]).count %></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="red "size="2">
            <b>Em Aberto: <%= @mmanutencaos_aberto = Mmanutencao.all(:conditions => ["situacao_manutencao_id= ?",1] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="red"><b>Alvenaria:</b><%= @mmanutencaos_alvenariaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Dedetização:</b><%= @mmanutencaos_dedetizacaoA= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletroA= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Elétrica:</b><%= @mmanutencaos_eletricaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Cozinha:</b><%= @mmanutencaos_cozinhaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=1"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b>Hidráulica:</b><%= @mmanutencaos_hidraulicaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Marcenaria:</b><%= @mmanutencaos_marcenariaA= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Pintura:</b><%= @mmanutencaos_pinturaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%" colspan="2"><font color ="red"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_aguaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=1"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="red"><b>Playground:</b><%= @mmanutencaos_playA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Pode Grama:</b><%= @mmanutencaos_serralheriaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Serralheira:</b><%= @mmanutencaos_telhadoA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Telhado:</b><%= @mmanutencaos_gramaA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=1"]).count %></font></td>
          <td width="15%"><font color ="red"><b>Outros:</b><%= @mmanutencaos_outrosA = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=1"]).count %></font></td>
        </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="blue "size="2">
            <b>Em Encerrado: <%= @mmanutencaos_encerrado = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 2"] ).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="blue"><b>Alvenaria:</b><%= @mmanutencaos_alvenariaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Dedetização:</b><%= @mmanutencaos_dedetizacaoE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletroE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Elétrica:</b><%= @mmanutencaos_eletricaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Cozinha:</b><%= @mmanutencaos_cozinhaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=2"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b>Hidráulica:</b><%= @mmanutencaos_hidraulicaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Marcenaria:</b><%= @mmanutencaos_marcenariaE= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Pintura:</b><%= @mmanutencaos_pinturaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%" colspan="2"><font color ="blue"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_aguaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=2"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="blue"><b>Playground:</b><%= @mmanutencaos_playE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Pode grama:</b><%= @mmanutencaos_serralheriaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Serralheira:</b><%= @mmanutencaos_telhadoE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Telhado:</b><%= @mmanutencaos_gramaE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=2"]).count %></font></td>
          <td width="15%"><font color ="blue"><b>Outros:</b><%= @mmanutencaos_outrosE = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=2"]).count %></font></td>
       </tr>
        <tr>
          <td rowspan="3" align="right" valign="top">
           <font color ="gren "size="2">
            <b>Em Atendimento: <%= @mmanutencaos_atendimento = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 3 OR situacao_manutencao_id= 4 "]).count %></b>
           </font>
          </td>
          <td width="15%"><font color ="gren"><b>Alvenaria:</b><%= @mmanutencaos_alvenariaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id=1 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Dedetização:</b><%= @mmanutencaos_dedetizacaoAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 3 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Eletrodomésticos:</b><%= @mmanutencaos_eletroAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 4 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Elétrica:</b><%= @mmanutencaos_eletricaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 5 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Cozinha:</b><%= @mmanutencaos_cozinhaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 6 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b>Hidráulica:</b><%= @mmanutencaos_hidraulicaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 7 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Marcenaria:</b><%= @mmanutencaos_marcenariaAT= Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 9 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Pintura:</b><%= @mmanutencaos_pinturaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 10 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%" colspan="2"><font color ="gren"><b>Limpeza Cx.D'Agua:</b><%= @mmanutencaos_aguaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 8 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
        </tr>
        <tr>
          <td width="15%"><font color ="gren"><b>Playground:</b><%= @mmanutencaos_playAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 11 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Poda Grama:</b><%= @mmanutencaos_serralheriaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 12 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Serralheria:</b><%= @mmanutencaos_telhadoAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 13 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Telhado:</b><%= @mmanutencaos_gramaAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 14 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
          <td width="15%"><font color ="gren"><b>Outros:</b><%= @mmanutencaos_outrosAT = Mmanutencao.all(:joins => 'INNER JOIN mmanutencaos_tipos_manutencaos ON mmanutencaos.id = mmanutencaos_tipos_manutencaos.mmanutencao_id', :conditions => ["mmanutencaos_tipos_manutencaos.tipos_manutencao_id= 15 and situacao_manutencao_id=3 OR situacao_manutencao_id=4"]).count %></font></td>
       </tr>




        <tr>
          <td >
            <%  session[:ano] =(Date.today.year)%>
            <%  session[:mes] =(Date.today.month)%>
            <%  $data = session[:ano] =(Date.today.year).to_s+'-'+(Date.today.month).to_s+'-'+'01' %>
            <%=  @mmanutencaos_aberto = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 1 and created_at > ?", $data] ).count%></td>
           <td>
            <%  session[:ano] =(Date.today.year)%>
            <%  session[:mes] =(Date.today.month)%>
            <%  $data = session[:ano] =(Date.today.year).to_s+'-'+(Date.today.month).to_s+'-'+'01' %>
            <%=  @mmanutencaos_aberto = Mmanutencao.all(:conditions => ["situacao_manutencao_id= 1 and created_at > ?", $data] ).count%></td>

        </tr>
      </table>
    </td>
   </tr>
</table>